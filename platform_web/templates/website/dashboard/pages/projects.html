{% extends 'website/dashboard/parts/layout.html' %}
{% load static %}

{% block title %}
  Level {{ lesson_id }} | {{ website_config.site_name }}
{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/dashboard/dashboard.css' %}" />
  <link rel="stylesheet" href="{% static 'css/dashboard/projects.css' %}" />
{% endblock %}

{% block extra_js %}
  <script src="{% static 'js/dashboard/dashboard.js' %}" defer type="module"></script>
  <script src="{% static 'js/dashboard/parts/codepen.js' %}" defer type="module"></script>
{% endblock %}

{% block dashboard_content %}

<section class="row align-items-end mb-2">
  <div class="col dashboard-title head-title d-flex align-items-center justify-content-between">
    <div class="left">
      <h1>Projects</h1>
      <ul class="breadcrumb">
        <li>
          <a href="#">Dashboard</a>
        </li>
        <li>
          <i class="fs-6 bi bi-caret-right-fill"></i>
        </li>
        <li>
          {% if user.is_staff %}
          <a class="active" target="_blank" href="/cp/platform_web/project/">Projects</a>
          {% else %}
          <a class="active" href="#">Projects</a>
          {% endif %}
        </li>
      </ul>
    </div>
    <!-- Plus button moved to bottom right -->
    {% if user.is_staff %}
    <a href="/cp/platform_web/project/add/" target="_blank"
       class="btn d-flex align-items-center justify-content-center"
       style="position: fixed; right: 36px; bottom: 36px; z-index: 1050; border-radius: 50%; width: 60px; height: 60px; font-size: 2rem; background: #007bff; color: #fff; box-shadow: 0 4px 16px rgba(0,0,0,0.12);"
       title="Add New Project">
      <i class="bi bi-plus"></i>
    </a>
    {% endif %}
  </div>

  <div class="col row justify-content-end align-items-end">

    <form method="get" class="projects-toggle-section col col-6 d-flex justify-content-end column-gap-3 mb-3" >
      <div class="d-flex flex-column align-items-end">
        <select id="projects-toggle-select" name="filter" class="form-select" style="width: auto;" onchange="this.form.submit()">
          <option value="course" {% if filter_by == 'course' %} selected {% endif %}> By Course </option>
          <option value="language" {% if filter_by == 'language' %} selected {% endif %}> By Language </option>
        </select>
        </div>
      <div class="d-flex flex-column align-items-end">
        <select id="projects-type-select" name="type" class="form-select" style="width: auto;" onchange="this.form.submit()">
          <option value="all" {% if project_type == 'all' or not project_type %}selected{% endif %}>All</option>
          <option value="topic" {% if project_type == 'topic' %}selected{% endif %}>Topic</option>
          <option value="project" {% if project_type == 'project' %}selected{% endif %}>Project</option>
        </select>
      </div>
    </form>
  </div>
</section>


  <section class="projects">
    {% comment %} ! add an edit pen / delete icon for each project  {% endcomment %}
      {% if filter_by == 'course' %}
      {% include 'website/dashboard/parts/projects_by_course.html' %}
      {% else %}
      {% include 'website/dashboard/parts/projects_by_language.html' %}
      {% endif %}
  </section>

  {% comment %} </section> {% endcomment %}
{% endblock %}
